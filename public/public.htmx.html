<!doctype html>
<html lang="fr" data-page-role="public">
<head>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#1650E0" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#1a1a1a" media="(prefers-color-scheme: dark)">
  <meta name="description" content="Écran de projection - Résultats en direct">
  <title>Écran public — AG-VOTE</title>
  <script src="/assets/js/theme-init.js"></script>
  <link rel="stylesheet" href="/assets/css/design-system.css">
  <link rel="stylesheet" href="/assets/css/public.css">
</head>
<body class="projection-body">

<header class="projection-header">
  <div class="header-left">
    <span class="status-badge off" id="badge">hors séance</span>
    <span class="motion-counter" id="motionCounter" hidden>
      <span id="motionCounterText">— / —</span>
    </span>
    <span class="meeting-title" id="meeting_title">Aucune séance</span>
  </div>
  <div class="clock" id="clock">--:--</div>
  <div class="projection-controls">
    <div class="projection-mode-toggle" id="projectionModeToggle" hidden>
      <button class="projection-mode-btn active" data-mode="vote" type="button">Vote</button>
      <button class="projection-mode-btn" data-mode="result" type="button">R&eacute;sultats</button>
    </div>
    <button class="projection-btn" id="btnChangeMeeting" title="Changer de séance" aria-label="Changer de séance" hidden>
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="1 4 1 10 7 10"/><polyline points="23 20 23 14 17 14"/><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/></svg>
    </button>
    <button class="projection-btn" id="btnThemeToggle" title="Basculer clair/sombre" aria-label="Basculer le thème">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
    </button>
    <button class="projection-btn" id="btnFullscreen" title="Plein écran" aria-label="Activer le plein écran">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" y1="3" x2="14" y2="10"/><line x1="3" y1="21" x2="10" y2="14"/></svg>
    </button>
  </div>
</header>

<main class="projection-main">
  <!-- Motion title -->
  <section class="motion-section">
    <div class="motion-number" id="motion_number"></div>
    <h1 class="motion-title" id="motion_title">—</h1>
    <p class="motion-subtitle" id="motion_sub"></p>
  </section>

  <!-- Resolution text -->
  <div class="resolution-box" id="resolution_box">
    <div class="resolution-text" id="resolution_text"></div>
  </div>

  <!-- Waiting state -->
  <div class="waiting-state" id="waiting_state">
    <svg class="waiting-icon" viewBox="0 0 24 24" fill="none">
      <!-- Cadran -->
      <circle class="clock-face" cx="12" cy="12" r="10" stroke-width="1.5"/>
      <!-- Repères heures (12, 3, 6, 9) -->
      <line class="clock-face" x1="12" y1="3" x2="12" y2="5" stroke-width="1"/>
      <line class="clock-face" x1="21" y1="12" x2="19" y2="12" stroke-width="1"/>
      <line class="clock-face" x1="12" y1="21" x2="12" y2="19" stroke-width="1"/>
      <line class="clock-face" x1="3" y1="12" x2="5" y2="12" stroke-width="1"/>
      <!-- Aiguille des heures -->
      <line class="clock-hand clock-hand-hour" x1="12" y1="12" x2="12" y2="7"/>
      <!-- Aiguille des minutes -->
      <line class="clock-hand clock-hand-minute" x1="12" y1="12" x2="12" y2="5"/>
      <!-- Aiguille des secondes -->
      <line class="clock-hand clock-hand-second" x1="12" y1="12" x2="12" y2="4"/>
      <!-- Centre -->
      <circle cx="12" cy="12" r="1" fill="currentColor"/>
    </svg>
    <h3 class="waiting-title">En attente</h3>
    <p class="waiting-text">Aucune résolution ouverte</p>
  </div>

  <!-- Secret vote -->
  <div class="secret-block" id="secret_block">
    <div class="secret-icon">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
      </svg>
    </div>
    <h4 class="secret-title">Vote secret</h4>
    <p class="secret-text">Résultats affichés à la clôture</p>
    <div class="participation-bar">
      <div class="participation-fill" id="participation_bar" style="width: 0%;"></div>
    </div>
    <div class="participation-text"><span id="participation_pct">0</span>% de participation</div>
  </div>

  <!-- Bar chart -->
  <div class="chart-container" id="chart_container">
    <div class="bar-chart">
      <div class="bar-item for" id="bar_for">
        <div class="bar-label-top">
          <div class="bar-percentage" id="pct_for">0%</div>
          <div class="bar-count"><span id="count_for">0</span> voix</div>
        </div>
        <div class="bar-wrapper">
          <div class="bar" id="bar_for_fill"></div>
        </div>
        <div class="bar-label">Pour</div>
      </div>
      <div class="bar-item against" id="bar_against">
        <div class="bar-label-top">
          <div class="bar-percentage" id="pct_against">0%</div>
          <div class="bar-count"><span id="count_against">0</span> voix</div>
        </div>
        <div class="bar-wrapper">
          <div class="bar" id="bar_against_fill"></div>
        </div>
        <div class="bar-label">Contre</div>
      </div>
      <div class="bar-item abstain" id="bar_abstain">
        <div class="bar-label-top">
          <div class="bar-percentage" id="pct_abstain">0%</div>
          <div class="bar-count"><span id="count_abstain">0</span> voix</div>
        </div>
        <div class="bar-wrapper">
          <div class="bar" id="bar_abstain_fill"></div>
        </div>
        <div class="bar-label">Abstention</div>
      </div>
    </div>
  </div>

  <!-- Quorum visual bar -->
  <div class="quorum-visual" id="quorumVisual" hidden>
    <div class="quorum-visual-header">
      <span class="quorum-visual-label">Quorum</span>
      <span class="quorum-visual-value" id="quorumVisualValue">&mdash;</span>
    </div>
    <div class="quorum-visual-bar">
      <div class="quorum-visual-fill met" id="quorumVisualFill" style="width: 0%"></div>
      <div class="quorum-seuil" id="quorumSeuil" style="left: 50%" data-label="Seuil"></div>
    </div>
  </div>

  <!-- Decision -->
  <section class="decision-section" id="decision_section">
    <div class="decision-grid">
      <div class="decision-card">
        <div class="decision-label">Decision</div>
        <div class="decision-value" id="decision_value">—</div>
        <div class="decision-detail" id="decision_detail"></div>
      </div>
      <div class="decision-card">
        <div class="decision-label">Quorum</div>
        <div class="decision-value" id="quorum_value">—</div>
        <div class="decision-detail" id="quorum_detail"></div>
      </div>
    </div>
    <span class="voter-total" id="voterTotal" hidden>
      <span id="voterTotalText">0 votants</span>
    </span>
  </section>

  <!-- Error -->
  <div class="error-box" id="error_box"></div>

  <!-- Meeting picker (multiple live meetings) -->
  <div class="meeting-picker-overlay" id="meeting_picker" hidden>
    <div class="meeting-picker">
      <div class="meeting-picker-icon">
        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
      </div>
      <h2 class="meeting-picker-title">Plusieurs séances en cours</h2>
      <p class="meeting-picker-sub">Sélectionnez la séance à projeter</p>
      <div class="meeting-picker-list" id="meeting_picker_list"></div>
    </div>
  </div>
</main>

<!-- Resolution tracker pills -->
<div class="resolution-tracker" id="resolutionTracker" hidden aria-label="Progression des r&eacute;solutions">
  <!-- Pills dynamically filled by JS -->
</div>

<footer class="projection-footer">
  <span class="footer-brand">AG-VOTE</span>
  <span class="footer-update" id="footer_update"></span>
</footer>

<div class="sr-only" id="sr_alert" aria-live="assertive" aria-atomic="true"></div>

<script src="/assets/js/pages/public.js"></script>

</body>
</html>
